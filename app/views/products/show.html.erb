<div class="col-xs-6">
    <%= image_tag @product.image.url(:medium) %>
</div>
<div class="col-xs-6">
    <h4><%= @product.name %></h4>
    <div class="star-rating" data-score= <%= @avg_review %> ></div>

  <p><%= @product.description %></p>

  <p><strong>Retail:</strong> <span class="crossed-price"><%= number_to_currency @product.retail %></span></p>
  <p><strong>Member Price:</strong> <span class="price"><%= number_to_currency @product.price %></span></p>
</div>
<%= link_to "Purchase", "#", class: "btn btn-success btn-lg" %>
<%= link_to "Add to Cart", "#", class: "btn btn-warning btn-lg" %>
<% if current_user.admin? %>
    <%= link_to "Edit", edit_product_path(@product), class: "btn btn-default btn-lg" %>
    <%= link_to "Delete", product_path(@product), class: "btn btn-danger btn-lg",method: :delete, data: { confirm: "Are you sure?" } %>
<% end %>

<div class="row">
  <div class="col-xs-12 no-review">
    <% if @reviews.blank? %>
        <h4>No reviews yet. Be the first!</h4>
        <%= link_to "Write a Review", new_product_review_path(@product), class: "btn btn-info btn-lg" %>
    <% else %>
        <h4 class="reviews">Reviews</h4>(<%= pluralize(@reviews.count, "Customer Review") %>)</em>
        <% @reviews.each do |review| %>
        <div class="review_title">
          <div class="star-rating" data-score="<%= review.rating %>"></div>
          <p><%= review.comment %></p>
          <p class="ago">Reviewed about <%= time_ago_in_words(review.created_at) %> ago</p>
        </div>
     <% end %>
        <%= link_to "Write a Review", new_product_review_path(@product), class: "btn btn-info btn-lg" %>
    <% end %>
  </div>
</div>

<script>
  $(".star-rating").raty({
     path: "/assets/",
     readOnly: true,
      score: function() {
          return $(this).attr("data-score");
      }
  });
</script>
